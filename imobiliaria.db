CREATE DATABASE IF NOT EXISTS imobiliaria_db;
USE imobiliaria_db;

CREATE TABLE cliente (
  id INT AUTO_INCREMENT PRIMARY KEY,
  nome VARCHAR(120) NOT NULL,
  cpf VARCHAR(14) NOT NULL UNIQUE,
  telefone VARCHAR(30),
  email VARCHAR(120)
);

CREATE TABLE imovel (
  id INT AUTO_INCREMENT PRIMARY KEY,
  endereco VARCHAR(200) NOT NULL,
  tipo VARCHAR(60) NOT NULL,
  quartos INT NOT NULL,
  banheiros INT NOT NULL,
  area_m2 DECIMAL(10,2) NOT NULL,
  preco_base DECIMAL(12,2) NOT NULL,
  status ENUM('DISPONIVEL','ALUGADO') DEFAULT 'DISPONIVEL'
);

CREATE TABLE contrato (
  id INT AUTO_INCREMENT PRIMARY KEY,
  imovel_id INT NOT NULL,
  cliente_id INT NOT NULL,
  valor_mensal DECIMAL(12,2) NOT NULL,
  data_inicio DATE NOT NULL,
  data_fim DATE NOT NULL,
  criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (imovel_id) REFERENCES imovel(id),
  FOREIGN KEY (cliente_id) REFERENCES cliente(id),
  CHECK (data_fim > data_inicio)
);
